import socket
import random
import time
from pyModbusTCP.server import ModbusServer

hostname = socket.gethostname()
server_ip_address = socket.gethostbyname(hostname)
server_port = 502
print(f"[+]Info : IP Address for Modbus Server : {server_ip_address}")

server = ModbusServer(server_ip_address, server_port, no_block=True)
server.start()

print(f"[+]info : Server is Online on IP : {server_ip_address} and PORT : {server_port} ")

# Initialize holding registers with zeros
holding_registers = [0] * 4

# Keep the script running indefinitely
try:
    while True:
        # Generate random data for four registers
        random_data = [random.randint(0, 65535) for _ in range(4)]

        # Update the holding registers
        for i, value in enumerate(random_data):
            server._write_single_register(i, value)

        print("Random data:", random_data)
        time.sleep(1)  # Wait for a second before generating the next set of data

except KeyboardInterrupt:
    server.stop()
import socket
import random
import time
from pyModbusTCP.server import ModbusServer

hostname = socket.gethostname()
server_ip_address = socket.gethostbyname(hostname)
server_port = 502
print(f"[+]Info : IP Address for Modbus Server : {server_ip_address}")

server = ModbusServer(server_ip_address, server_port, no_block=True)
server.start()

print(f"[+]info : Server is Online on IP : {server_ip_address} and PORT : {server_port} ")

# Initialize holding registers with zeros
holding_registers = [0] * 4

# Keep the script running indefinitely
try:
    while True:
        # Generate random data for four registers
        random_data = [random.randint(0, 65535) for _ in range(4)]

        # Update the holding registers
        for i, value in enumerate(random_data):
            server._write_single_register(i, value)

        print("Random data:", random_data)
        time.sleep(1)  # Wait for a second before generating the next set of data

except KeyboardInterrupt:
    server.stop()
